<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B·∫£ng Ki·ªÉm: L√†m Ch·ªß AI</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        /* --- C√†i ƒë·∫∑t Chung --- */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 24px;
            background: linear-gradient(to right, #f0f8ff, #e6f0ff);
            color: #333;
            line-height: 1.6;
            -webkit-overflow-scrolling: touch; 
        }
        .page-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 24px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .card {
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            padding: 24px 30px;
        }

        /* --- C·ªôt Checklist (B√™n tr√°i) --- */
        .checklist-container h1 {
            font-size: 2em;
            margin-top: 0;
            color: #111;
        }
        .checklist-container .subtitle {
            font-size: 0.95em;
            color: #555;
            margin-bottom: 20px;
        }
        .section {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        .section:last-child {
            border-bottom: none;
        }
        .section h2 {
            font-size: 1.3em;
            color: #0056b3;
            margin-bottom: 15px;
            transition: color 0.2s ease;
        }
        .section h2:hover {
            color: #003a75; 
        }
        
        .checklist-item {
            display: flex;
            align-items: center;
            margin: 0 -8px 12px -8px;
            padding: 4px 8px;
            border-radius: 6px;
            transition: background-color 0.2s ease, transform 0.2s ease;
        }
        .checklist-item:hover {
            background-color: #f4f9ff; 
            transform: scale(1.02);
        }
        
        .checklist-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin-right: 12px;
            accent-color: #0056b3;
            cursor: pointer;
        }
        .checklist-item label {
            font-size: 1em;
            cursor: pointer;
            flex: 1;
        }
        
        /* --- C·ªôt K·∫øt qu·∫£ (B√™n ph·∫£i) --- */
        .results-container h2 {
            font-size: 1.3em;
            margin-top: 0;
            color: #111;
        }
        .results-card {
            position: sticky; 
            top: 24px;
        }

        /* Box ph·∫£n h·ªìi ch√≠nh */
        .feedback-message {
            display: flex;
            align-items: flex-start;
            padding: 12px 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            font-size: 1.05em;
            font-weight: 500;
            border-left: 5px solid;
        }
        .feedback-message .icon {
            font-size: 1.3em;
            margin-right: 12px;
            margin-top: -2px;
        }
        .feedback-message.default {
            border-color: #aaa;
            background-color: #f8f8f8;
        }
        .feedback-message.improve {
            border-color: #d9534f;
            background-color: #fdf7f7;
            color: #a94442;
        }
        .feedback-message.good {
            border-color: #f0ad4e;
            background-color: #fefbf5;
            color: #8a6d3b;
        }
        .feedback-message.excellent {
            border-color: #5cb85c;
            background-color: #f7fcf7;
            color: #3c763d;
            animation: pulse-animation 2s infinite;
        }

        /* Th·∫ª tag ti·∫øn tr√¨nh */
        .section-progress-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }
        .progress-tag {
            font-size: 0.85em;
            font-weight: 500;
            padding: 4px 10px;
            border-radius: 15px;
            background-color: #e9ecef;
            color: #495057;
        }
        .progress-tag.completed {
            background-color: #e7f3ff;
            color: #0056b3;
        }
        .progress-tag .fraction {
            margin-left: 5px;
            opacity: 0.7;
        }

        /* G·ª£i √Ω c·∫£i thi·ªán */
        .suggestions-box {
            margin-bottom: 20px;
        }
        .suggestions-box h3 {
            font-size: 1em;
            color: #111;
            margin: 0 0 8px 0;
        }
        .suggestions-box p {
            font-size: 0.9em;
            color: #555;
            margin: 0;
        }

        /* N√∫t ch·ª©c nƒÉng */
        .button-group {
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap; 
            gap: 10px;
        }
        .button-group button {
            padding: 9px 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 0.9em;
            font-weight: 600;
            cursor: pointer;
            background-color: #fff;
            color: #333;
            transition: background-color 0.2s, box-shadow 0.2s;
        }
        .button-group button:hover {
            background-color: #f8f8f8;
        }
        .button-group button#copyButton {
            background-color: #f8f9fa;
        }
        .button-group button#resetButton {
            background-color: #f8f9fa;
        }

        /* Mini T√¨nh hu·ªëng */
        .mini-case {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid #f39c12;
            background-color: #fffaf0;
        }
        .mini-case h3 {
            margin: 0 0 10px 0;
            color: #111;
            font-size: 1.1em;
        }
        .mini-case p {
            font-size: 0.95em;
            margin: 0 0 10px 0;
            color: #333;
        }
        .mini-case ul {
            margin: 0;
            padding-left: 20px;
            font-size: 0.95em;
            color: #333;
        }
        
        /* CSS cho Thanh Ti·∫øn ƒë·ªô */
        .progress-section {
            margin-bottom: 20px;
        }
        .progress-track {
            width: 100%;
            height: 12px;
            background-color: #e9ecef;
            border-radius: 6px;
            overflow: hidden;
        }
        .progress-bar {
            width: 0%; 
            height: 100%;
            background: linear-gradient(to right, #007bff, #5cb85c, #f0ad4e);
            border-radius: 6px;
            transition: width 0.4s ease;
        }
        .progress-display {
            margin-top: 10px;
            display: flex;
            align-items: baseline;
        }
        .progress-percentage {
            font-size: 2.8em; 
            font-weight: 700;
            color: #111;
            line-height: 1.1;
        }
        .progress-count {
            font-size: 1em;
            font-weight: 500;
            color: #555;
            margin-left: 8px;
        }
        
        /* CSS cho N√∫t Xu·∫•t File */
        .button-group button#exportButton {
            background-color: #0056b3;
            color: #fff;
            border-color: #0056b3;
        }
        .button-group button#exportButton:hover {
            background-color: #004494;
        }
        .button-group button#exportButton:disabled {
            background-color: #aaa;
            cursor: not-allowed;
        }
        
        /* CSS cho Hi·ªáu ·ª©ng th√∫ v·ªã */
        @keyframes pulse-animation {
            0% { box-shadow: 0 0 0 0 rgba(92, 184, 92, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(92, 184, 92, 0); }
            100% { box-shadow: 0 0 0 0 rgba(92, 184, 92, 0); }
        }

        .reward-box {
            margin-top: 20px;
            padding: 15px 20px;
            background: linear-gradient(to right, #fffaf0, #fdf6e3);
            border: 2px dashed #f39c12;
            border-radius: 8px;
            text-align: center;
        }
        .reward-box h3 {
            margin: 0 0 5px 0;
            color: #d9534f;
            font-size: 1.2em;
        }
        .reward-box p {
            margin: 0;
            font-size: 0.95em;
            color: #333;
        }

        /* Responsive (S·ª≠a l·ªói di ƒë·ªông) */
        @media (max-width: 900px) { 
            .page-container {
                grid-template-columns: 1fr;
            }
            .results-container {
                order: -1;
            }
            .results-card {
                position: static;
            }
            body {
                padding: 16px;
            }
        }
        
        /* === PH·∫¶N M·ªöI TH√äM: CSS D·ªåN D·∫∏P KHI XU·∫§T PDF === */
        /* Th√™m l·ªõp n√†y v√†o body ƒë·ªÉ t·∫°m th·ªùi t·∫Øt c√°c hi·ªáu ·ª©ng */
        body.is-exporting-pdf .results-card {
            position: static !important; /* Quan tr·ªçng nh·∫•t: T·∫Øt sticky */
            box-shadow: none !important; /* T·∫Øt ƒë·ªï b√≥ng */
        }
        
        body.is-exporting-pdf .checklist-item {
             transform: none !important; /* T·∫Øt hi·ªáu ·ª©ng pop */
             background-color: transparent !important;
        }
        
        body.is-exporting-pdf .feedback-message.excellent {
            animation: none !important; /* T·∫Øt hi·ªáu ·ª©ng pulse */
            box-shadow: none !important;
        }
        /* === K·∫æT TH√öC B·ªî SUNG === */

    </style>
</head>
<body>

    <div class="page-container">
        
        <div class="checklist-container card">
            <h1>B·∫£ng Ki·ªÉm: L√†m Ch·ªß AI Trong H·ªçc T·∫≠p</h1>
            <p class="subtitle">Chia theo 5 nh√≥m: C√° nh√¢n h√≥a, M·ª•c ƒë√≠ch, Minh b·∫°ch, Ki·ªÉm ch·ª©ng & ƒê·∫°o ƒë·ª©c, Ph·∫£n t∆∞.</p>
            
            <form id="aiChecklistForm">
                
                <div class="section" id="section-1" data-section-name="C√° nh√¢n h√≥a">
                    <h2>1. C√° nh√¢n h√≥a v√† ph√°t tri·ªÉn nƒÉng l·ª±c t·ª± h·ªçc</h2>
                    <div class="checklist-item">
                        <input type="checkbox" id="q1_1" name="q1_1">
                        <label for="q1_1">T√¥i d√πng AI ƒë·ªÉ x√¢y d·ª±ng l·ªô tr√¨nh h·ªçc t·∫≠p c√° nh√¢n.</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="q1_2" name="q1_2">
                        <label for="q1_2">T√¥i ghi ch√∫ v√† t·ªïng h·ª£p l·∫°i ki·∫øn th·ª©c sau khi l√†m vi·ªác v·ªõi AI, thay v√¨ ch·ªâ l∆∞u tr·ªØ ph·∫£n h·ªìi.</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="q1_3" name="q1_3">
                        <label for="q1_3">T√¥i nh·∫≠n th·∫•y nƒÉng l·ª±c t·ª± h·ªçc c·ªßa m√¨nh ƒë∆∞·ª£c c·∫£i thi·ªán nh·ªù bi·∫øt c√°ch s·ª≠ d·ª•ng AI ch·ªß ƒë·ªông, c√≥ ƒë·ªãnh h∆∞·ªõng.</label>
                    </div>
                </div>

                <div class="section" id="section-2" data-section-name="M·ª•c ƒë√≠ch">
                    <h2>2. M·ª•c ƒë√≠ch s·ª≠ d·ª•ng</h2>
                    <div class="checklist-item">
                        <input type="checkbox" id="q2_1" name="q2_1">
                        <label for="q2_1">T√¥i ch·ªâ d√πng AI ƒë·ªÉ h·ªó tr·ª£ hi·ªÉu b√†i, tra c·ª©u ho·∫∑c luy·ªán t·∫≠p.</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="q2_2" name="q2_2">
                        <label for="q2_2">T√¥i ƒë√£ x√°c ƒë·ªãnh r√µ m·ª•c ti√™u h·ªçc t·∫≠p tr∆∞·ªõc khi s·ª≠ d·ª•ng AI.</label>
                    </div>
                    
                    <div class="checklist-item">
                        <input type="checkbox" id="q2_3" name="q2_3">
                        <label for="q2_3">T√¥i kh√¥ng d√πng AI ƒë·ªÉ l√†m b√†i t·∫≠p h·ªô ho·∫∑c gian l·∫≠n thi c·ª≠.</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="q2_4" name="q2_4">
                        <label for="q2_4">T√¥i s·ª≠ d·ª•ng AI ƒë·ªÉ kh√°m ph√° c√°c ch·ªß ƒë·ªÅ li√™n quan, m·ªü r·ªông ki·∫øn th·ª©c ngo√†i gi√°o tr√¨nh.</label>
                    </div>
                </div>

                <div class="section" id="section-3" data-section-name="Minh b·∫°ch">
                    <h2>3. Minh b·∫°ch trong c√¢u l·ªánh (Prompt)</h2>
                    <div class="checklist-item">
                        <input type="checkbox" id="q3_1" name="q3_1">
                        <label for="q3_1">T√¥i cung c·∫•p ƒë·∫ßy ƒë·ªß b·ªëi c·∫£nh v√† th√¥ng tin n·ªÅn cho AI.</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="q3_2" name="q3_2">
                        <label for="q3_2">T√¥i ƒë·ªãnh r√µ vai tr√≤ (persona) cho AI (v√≠ d·ª•: "gi·∫£ l√†m chuy√™n gia", "gi·∫£ng vi√™n").</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="q3_3" name="q3_3">
                        <label for="q3_3">T√¥i ch·ªâ r√µ ƒë·ªãnh d·∫°ng ƒë·∫ßu ra mong mu·ªën (v√≠ d·ª•: g·∫°ch ƒë·∫ßu d√≤ng, b·∫£ng, t√≥m t·∫Øt).</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="q3_4" name="q3_4">
                        <label for="q3_4">T√¥i y√™u c·∫ßu AI gi·∫£i th√≠ch t·ª´ng b∆∞·ªõc (step-by-step) ƒë·ªÉ hi·ªÉu t∆∞ duy c·ªßa n√≥.</label>
                    </div>
                </div>

                <div class="section" id="section-4" data-section-name="Ki·ªÉm ch·ª©ng & ƒê·∫°o ƒë·ª©c">
                    <h2>4. Ki·ªÉm ch·ª©ng v√† ƒë·∫°o ƒë·ª©c h·ªçc thu·∫≠t</h2>
                    <div class="checklist-item">
                        <input type="checkbox" id="q4_1" name="q4_1">
                        <label for="q4_1">T√¥i ki·ªÉm ch·ª©ng l·∫°i th√¥ng tin do AI cung c·∫•p b·∫±ng √≠t nh·∫•t m·ªôt ngu·ªìn ƒë√°ng tin c·∫≠y kh√°c.</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="q4_2" name="q4_2">
                        <label for="q4_2">T√¥i tr√≠ch d·∫´n r√µ r√†ng n·ªôi dung, √Ω t∆∞·ªüng ho·∫∑c ƒëo·∫°n vƒÉn t·ª´ AI.</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="q4_3" name="q4_3">
                        <label for="q4_3">T√¥i ƒë√£ ƒë·∫£m b·∫£o r·∫±ng n·ªôi dung do AI t·∫°o ra (n·∫øu c√≥) kh√¥ng b·ªã tr√¨nh b√†y nh∆∞ l√† nghi√™n c·ª©u ho√†n to√†n c·ªßa t√¥i.</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="q4_4" name="q4_4">
                        <label for="q4_4">T√¥i kh√¥ng sao ch√©p nguy√™n vƒÉn ph·∫£n h·ªìi c·ªßa AI ƒë·ªÉ n·ªôp nh∆∞ s·∫£n ph·∫©m h·ªçc t·∫≠p c·ªßa m√¨nh.</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="q4_5" name="q4_5">
                        <label for="q4_5">T√¥i lu√¥n ƒë·ªçc k·ªπ c√¢u tr·∫£ l·ªùi c·ªßa AI ƒë·ªÉ ph√°t hi·ªán l·ªói sai logic ho·∫∑c ki·∫øn th·ª©c.</label>
                    </div>
                </div>

                <div class="section" id="section-5" data-section-name="Ph·∫£n t∆∞">
                    <h2>5. Ph·∫£n t∆∞ v√† C·∫£i ti·∫øn</h2>
                    <div class="checklist-item">
                        <input type="checkbox" id="q5_1" name="q5_1">
                        <label for="q5_1">T√¥i ch·ªânh s·ª≠a (iterate) c√¢u l·ªánh nhi·ªÅu l·∫ßn n·∫øu AI ch∆∞a hi·ªÉu ƒë√∫ng √Ω.</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="q5_2" name="q5_2">
                        <label for="q5_2">T√¥i ph√¢n t√≠ch ph·∫£n h·ªìi c·ªßa AI ƒë·ªÉ t√¨m ra "l·ªó h·ªïng" ki·∫øn th·ª©c c·ªßa b·∫£n th√¢n.</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="q5_3" name="q5_3">
                        <label for="q5_3">T√¥i l∆∞u l·∫°i c√°c c√¢u l·ªánh (prompts) hi·ªáu qu·∫£ ƒë·ªÉ t√°i s·ª≠ d·ª•ng v√† c·∫£i ti·∫øn.</label>
                    </div>
                </div>

            </form>
        </div>
        
        <div class="results-container">
            <div class="results-card card">
                
                <h2>T·ªïng k·∫øt & G·ª£i √Ω</h2>

                <div class="progress-section">
                    <div class="progress-track">
                        <div class="progress-bar" id="progressBar"></div>
                    </div>
                    <div class="progress-display">
                        <span class="progress-percentage" id="progressPercentage">0%</span>
                        <span class="progress-count" id="progressCount">(0 / 19 m·ª•c)</span>
                    </div>
                </div>

                <div class="feedback-message default" id="feedbackMessage">
                    <span class="icon" id="feedbackIcon">‚è≥</span>
                    <span id="feedbackText">H√£y b·∫Øt ƒë·∫ßu ch·ªçn c√°c m·ª•c ƒë·ªÉ xem k·∫øt qu·∫£...</span>
                </div>

                <div class="section-progress-container" id="sectionProgressContainer">
                    </div>

                <div class="suggestions-box" id="suggestionsBox">
                    <h3>G·ª£i √Ω c·∫£i thi·ªán:</h3>
                    <p id="suggestionText">H√£y ch·ªçn √≠t nh·∫•t m·ªôt m·ª•c ƒë·ªÉ nh·∫≠n g·ª£i √Ω.</p>
                </div>

                <div class="button-group">
                    <button type="button" id="copyButton">Copy K·∫øt qu·∫£</button>
                    <button type="button" id="resetButton">L√†m l·∫°i</button>
                    <button type="button" id="exportButton">Xu·∫•t PDF</button>
                </div>

                <div class="mini-case">
                    <h3>üí° T√¨nh hu·ªëng Mini</h3>
                    <p><strong>H·ªçc vi√™n A:</strong> "M√¨nh d√πng AI vi·∫øt lu·∫≠n vƒÉn h·ªô."</p>
                    <p><strong>H·ªçc vi√™n B (L√†m ch·ªß AI):</strong> "M√¨nh d√πng AI ƒë·ªÉ:
                        <ul>
                            <li>Brainstorm 3 d√†n √Ω kh√°c nhau.</li>
                            <li>T√¨m 5 ngu·ªìn t√†i li·ªáu h·ªçc thu·∫≠t uy t√≠n v·ªÅ ch·ªß ƒë·ªÅ.</li>
                            <li>Ki·ªÉm tra l·∫°i ng·ªØ ph√°p v√† c√°ch h√†nh vƒÉn c·ªßa b√†i lu·∫≠n."</li>
                        </ul>
                    </p>
                </div>
                
                <div class="reward-box" id="reward-100" style="display: none;">
                    <h3>üèÜ B·∫°n l√† B·∫≠c Th·∫ßy AI!</h3>
                    <p>B·∫°n ƒë√£ ho√†n th√†nh 100% b·∫£ng ki·ªÉm. H√£y chia s·∫ª th√†nh t√≠ch n√†y!</p>
                </div>

            </div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            const { jsPDF } = window.jspdf;
            
            const form = document.getElementById('aiChecklistForm');
            const sections = form.querySelectorAll('.section');
            const allCheckboxes = form.querySelectorAll('input[type="checkbox"]');
            const totalItems = allCheckboxes.length; 

            const progressBar = document.getElementById('progressBar');
            const progressPercentage = document.getElementById('progressPercentage');
            const progressCount = document.getElementById('progressCount');
            const feedbackMessage = document.getElementById('feedbackMessage');
            const feedbackIcon = document.getElementById('feedbackIcon');
            const feedbackText = document.getElementById('feedbackText');
            const sectionProgressContainer = document.getElementById('sectionProgressContainer');
            const suggestionsBox = document.getElementById('suggestionsBox');
            const suggestionText = document.getElementById('suggestionText');
            
            const resetButton = document.getElementById('resetButton');
            const copyButton = document.getElementById('copyButton');
            const exportButton = document.getElementById('exportButton');
            
            const rewardBox = document.getElementById('reward-100');
            
            let totalChecked = 0; 

            const suggestions = {
                default: "H√£y ch·ªçn √≠t nh·∫•t m·ªôt m·ª•c ƒë·ªÉ nh·∫≠n g·ª£i √Ω.",
                'section-1': "B·∫°n ƒëang l√†m t·ªët ph·∫ßn c√° nh√¢n h√≥a. H√£y th·ª≠ d√πng AI ƒë·ªÉ t·∫°o c√°c c√¢u h·ªèi √¥n t·∫≠p d·ª±a tr√™n ghi ch√∫ c·ªßa b·∫°n.",
                'section-2': "M·ª•c ƒë√≠ch r√µ r√†ng l√† ch√¨√° kh√≥a. H√£y lu√¥n b·∫Øt ƒë·∫ßu c√¢u l·ªánh v·ªõi m·ª•c ti√™u (v√≠ d·ª•: 'So s√°nh', 'Ph√¢n t√≠ch', 'T√≥m t·∫Øt').",
                'section-3': "K·ªπ nƒÉng prompt r·∫•t t·ªët! Th·ª≠ th√°ch th√™m b·∫±ng c√°ch y√™u c·∫ßu AI tranh lu·∫≠n ng∆∞·ª£c l·∫°i v·ªõi quan ƒëi·ªÉm c·ªßa b·∫°n.",
                'section-4': "Tuy·ªát v·ªùi! Lu√¥n gi·ªØ t∆∞ duy ph·∫£n bi·ªán. H√£y th·ª≠ h·ªèi AI 'Ngu·ªìn c·ªßa th√¥ng tin n√†y l√† g√¨?' ƒë·ªÉ ki·ªÉm tra.",
                'section-5': "Ph·∫£n t∆∞ l√† c·ªët l√µi c·ªßa vi·ªác h·ªçc. H√£y l∆∞u l·∫°i m·ªôt cu·ªôc tr√≤ chuy·ªán AI th·∫•t b·∫°i v√† ph√¢n t√≠ch t·∫°i sao n√≥ kh√¥ng hi·ªáu qu·∫£."
            };

            // H√†m updateResults (Gi·ªØ nguy√™n)
            function updateResults() {
                totalChecked = 0; 
                let sectionsComplete = [];
                let firstUncheckedSection = null;

                sectionProgressContainer.innerHTML = ''; 

                sections.forEach(section => {
                    const sectionCheckboxes = section.querySelectorAll('input[type="checkbox"]');
                    const sectionTotal = sectionCheckboxes.length;
                    let sectionChecked = 0;

                    sectionCheckboxes.forEach(cb => {
                        if (cb.checked) {
                            sectionChecked++;
                        }
                    });

                    totalChecked += sectionChecked;

                    const sectionName = section.dataset.sectionName;
                    const tag = document.createElement('span');
                    tag.classList.add('progress-tag');
                    if (sectionChecked === sectionTotal) {
                        tag.classList.add('completed');
                        sectionsComplete.push(section.id);
                    } else {
                        if (!firstUncheckedSection) {
                            firstUncheckedSection = section.id;
                        }
                    }
                    tag.innerHTML = `${sectionName} <span class="fraction">(${sectionChecked}/${sectionTotal})</span>`;
                    sectionProgressContainer.appendChild(tag);
                });

                const percentage = totalItems > 0 ? (totalChecked / totalItems) * 100 : 0;
                progressBar.style.width = `${percentage}%`;
                progressPercentage.textContent = `${Math.round(percentage)}%`;
                progressCount.textContent = `(${totalChecked} / ${totalItems} m·ª•c)`; 

                let fClass = 'default';
                let fIcon = '‚è≥';
                let fText = 'H√£y b·∫Øt ƒë·∫ßu ch·ªçn c√°c m·ª•c ƒë·ªÉ xem k·∫øt qu·∫£...';

                if (totalChecked > 0) {
                    if (percentage < 40) {
                        fClass = 'improve';
                        fIcon = 'üòü';
                        fText = '**C·∫ßn c·∫£i thi·ªán** ‚Äî B·∫°n m·ªõi b·∫Øt ƒë·∫ßu. H√£y kh√°m ph√° th√™m c√°c k·ªπ nƒÉng kh√°c nh√©!';
                    } else if (percentage < 80) {
                        fClass = 'good';
                        fIcon = 'üëç';
                        fText = '**T·ªët** ‚Äî B·∫°n ƒë√£ c√≥ nh·∫≠n th·ª©c t·ªët v·ªÅ vi·ªác d√πng AI. Ti·∫øp t·ª•c ph√°t huy!';
                    } else {
                        fClass = 'excellent';
                        fIcon = 'üéâ';
                        fText = '‚ú® **Xu·∫•t s·∫Øc!** ‚Äî B·∫°n ƒëang l√†m ch·ªß AI m·ªôt c√°ch r·∫•t hi·ªáu qu·∫£ v√† c√≥ tr√°ch nhi·ªám!';
                    }
                }
                feedbackMessage.className = `feedback-message ${fClass}`;
                feedbackIcon.textContent = fIcon;
                feedbackText.innerHTML = fText;

                if (totalChecked === 0) {
                    suggestionText.textContent = suggestions.default;
                } else if (firstUncheckedSection) {
                    suggestionText.textContent = suggestions[firstUncheckedSection] || "H√£y ti·∫øp t·ª•c ho√†n th√†nh c√°c m·ª•c c√≤n l·∫°i.";
                } else {
                    suggestionText.textContent = "Tuy·ªát v·ªùi! B·∫°n ƒë√£ ho√†n th√†nh t·∫•t c·∫£. H√£y th·ª≠ d·∫°y ng∆∞·ªùi kh√°c c√°c k·ªπ nƒÉng n√†y nh√©!";
                }
                
                if (Math.round(percentage) === 100) {
                    rewardBox.style.display = 'block';
                } else {
                    rewardBox.style.display = 'none';
                }
            }
            
            // === H√ÄM XU·∫§T PDF ƒê√É S·ª¨A L·ªñI HO√ÄN CH·ªàNH ===
            function exportPDF() {
                // Ch·ªçn .page-container thay v√¨ body ƒë·ªÉ c√≥ kho·∫£ng tr·∫Øng ƒë·∫πp h∆°n
                const content = document.querySelector('.page-container'); 
                const originalButtonText = exportButton.textContent;
                exportButton.textContent = 'ƒêang t·∫°o PDF...';
                exportButton.disabled = true;

                // 1. Th√™m l·ªõp CSS ƒë·ªÉ "d·ªçn d·∫πp"
                document.body.classList.add('is-exporting-pdf');

                html2canvas(content, { 
                    scale: 2, // TƒÉng ch·∫•t l∆∞·ª£ng ·∫£nh
                    scrollY: -window.scrollY, // ƒê·∫£m b·∫£o ch·ª•p ƒë√∫ng v·ªã tr√≠ cu·ªôn
                    useCORS: true 
                }).then(canvas => {
                    // 2. X√≥a l·ªõp CSS ngay sau khi ch·ª•p xong
                    document.body.classList.remove('is-exporting-pdf');

                    const imgData = canvas.toDataURL('image/png');
                    
                    const pageHeight = 297; // A4 height in mm
                    const pageWidth = 210;  // A4 width in mm
                    
                    // T√≠nh to√°n t·ª∑ l·ªá ·∫£nh
                    const imgWidth = pageWidth - 20; // Tr·ª´ l·ªÅ 10mm m·ªói b√™n
                    const imgHeight = canvas.height * imgWidth / canvas.width;
                    
                    let heightLeft = imgHeight;
                    let position = 10; // B·∫Øt ƒë·∫ßu v·ªõi l·ªÅ tr√™n 10mm
                    
                    const pdf = new jsPDF('p', 'mm', 'a4'); 

                    // Th√™m trang ƒë·∫ßu ti√™n
                    pdf.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
                    heightLeft -= (pageHeight - 20); // Tr·ª´ ƒëi chi·ªÅu cao c√≥ th·ªÉ ch·ª©a (ƒë√£ tr·ª´ l·ªÅ)

                    // Th√™m c√°c trang m·ªõi n·∫øu n·ªôi dung d√†i
                    while (heightLeft > 0) {
                        position = -heightLeft + 10; // D·ªãch ·∫£nh l√™n + l·ªÅ tr√™n
                        pdf.addPage();
                        pdf.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
                        heightLeft -= (pageHeight - 20);
                    }
                    
                    pdf.save('ket-qua-checklist-ai.pdf');
                    
                    // 3. Kh√¥i ph·ª•c n√∫t
                    exportButton.textContent = originalButtonText;
                    exportButton.disabled = false;
                }).catch(err => {
                    // 4. N·∫øu l·ªói, c≈©ng x√≥a l·ªõp CSS v√† kh√¥i ph·ª•c n√∫t
                    console.error("L·ªói khi t·∫°o PDF:", err);
                    alert("Kh√¥ng th·ªÉ t·∫°o PDF. Vui l√≤ng th·ª≠ l·∫°i.");
                    document.body.classList.remove('is-exporting-pdf');
                    exportButton.textContent = originalButtonText;
                    exportButton.disabled = false;
                });
            }
            
            // H√†m copy (Gi·ªØ nguy√™n)
            function copyResults() {
                 let copyText = `K·∫øt qu·∫£: ${progressPercentage.textContent} (${progressCount.textContent}) - ${feedbackText.innerText}\n`;
                 copyText += `G·ª£i √Ω: ${suggestionText.textContent}`;
                 
                 navigator.clipboard.writeText(copyText).then(() => {
                     alert('ƒê√£ sao ch√©p k·∫øt qu·∫£ v√†o clipboard!');
                 }, () => {
                     alert('Sao ch√©p th·∫•t b·∫°i.');
                 });
            }

            // G√°n s·ª± ki·ªán (Gi·ªØ nguy√™n)
            form.addEventListener('change', updateResults);
            
            resetButton.addEventListener('click', () => {
                if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën l√†m l·∫°i t·ª´ ƒë·∫ßu?')) {
                    form.reset();
                    updateResults();
                }
            });
            
            copyButton.addEventListener('click', copyResults);
            
            exportButton.addEventListener('click', exportPDF);

            // C·∫≠p nh·∫≠t l·∫ßn ƒë·∫ßu (Gi·ªØ nguy√™n)
            updateResults();
        });
    </script>

</body>
</html>
